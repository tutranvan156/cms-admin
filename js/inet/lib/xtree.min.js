(function(c,g){var n=c.fn.xtree,h=function(a,b){this.$element=c(a);this.options=c.extend({},c.fn.xtree.defaults,b);this.$element.on("click",".tree-item",c.proxy(function(e){this.selectItem(e.currentTarget)},this));this.$element.on("click",".tree-folder-header",c.proxy(function(e){this.selectFolder(e.currentTarget)},this));this.render()};h.prototype={constructor:h,__init:function(){this.$element.html('<div class="tree-folder" style="display:none;"><div class="tree-folder-header"><i class="'+this.options.iconClose+
'"></i><div class="tree-folder-name"></div></div><div class="tree-folder-content"></div><div class="tree-loader" style="display:none"></div></div><div class="tree-item" style="display:none;">'+(null==this.options.iconUnSelected?"":'<i class="'+this.options.iconUnSelected+'"></i>')+'<div class="tree-item-name"></div></div>');this.$element.addClass(1==this.options.selectable?"tree-selectable":"tree-unselectable")},render:function(){this.__init();this.populate(this.$element)},populate:function(a){if(this.options.isRender){var b=
this,e=a.parent(),i=e.find(".tree-loader:eq(0)");i.show();this.options.dataSource.data(a.data(),function(j){i.hide();c.each(j.data,function(k,d){var f;if(d.type==="folder"){f=b.$element.find(".tree-folder:eq(0)").clone().show();f.find(".tree-folder-name").html(d.text||d.name);f.find(".tree-loader").html(b.options.loadingHTML);var m=f.find(".tree-folder-header");m.data(d);m.attr("id",d.id);"iconCls"in d&&m.find("i").addClass(d.iconCls);"additionalParameters"in d&&"item-selected"in d.additionalParameters&&
d.additionalParameters["item-selected"]==true&&setTimeout(function(){m.trigger("click")},0)}else if(d.type==="item"){var l="";f=b.$element.find(".tree-item:eq(0)").clone().show();if("iconCls"in d)l=d.iconCls;l=l!=""?'<i class="'+l+'"></i>'+(d.text||d.name):d.text||d.name;f.find(".tree-item-name").html(l);f.data(d);f.attr("id",d.id);if("additionalParameters"in d&&"item-selected"in d.additionalParameters&&d.additionalParameters["item-selected"]==true){f.addClass("tree-selected");f.find("i").removeClass(b.options.iconUnSelected).addClass(b.options.iconSelected)}}c.each(d.dataAttributes||
[],function(o,p){switch(o){case "class":case "classes":case "className":f.addClass(p);break;default:f.attr(o,p)}});a.hasClass("tree-folder-header")?e.find(".tree-folder-content:eq(0)").append(f):a.append(f)});b.$element.trigger("loaded",e)})}},selectItem:function(a){if(this.options.selectable!=false){var b=c(a);a=this.$element.find(".tree-selected");var e=[];if(this.options.multiSelect)c.each(a,function(i,j){c(j)[0]!==b[0]&&e.push(c(j).data())});else if(a[0]!==b[0]){a.removeClass("tree-selected").find("i").removeClass("icon-ok").addClass("tree-dot");
e.push(b.data())}a="selected";if(b.hasClass("tree-selected")){a="unselected";b.removeClass("tree-selected");b.find("i").removeClass("icon-ok").addClass("tree-dot")}else{b.addClass("tree-selected");b.find("i").removeClass("tree-dot").addClass("icon-ok");this.options.multiSelect&&e.push(b.data())}e.length&&this.$element.trigger("selected",{info:e});b.trigger("updated",{info:e,item:b,eventType:a})}},selectFolder:function(a){var b=this;a=c(a);var e=a.parent(),i=e.find(".tree-loader:eq(0)"),j=e.find(".tree-folder-content"),
k=j.eq(0),d="."+c.trim(this.options.iconClose.replace(/\s/g,".")),f,m,l;if(a.find(d).length){this.options.isRender=true;i.show();f="opened";m=this.options.iconClose;l=this.options.iconOpen;k.show();if(this.options.isRemoteItem)f==="opened"&&this.$element.trigger(f,[a.data(),a,function(o){b.populate(o)}]);else{j.children().length||this.populate(a);this.$element.trigger(f,[a.data(),a])}}else{this.options.isRender=false;d="."+c.trim(this.options.iconOpen.replace(/\s/g,"."));f="closed";m=this.options.iconOpen;
l=this.options.iconClose;k.hide();this.options.cacheItems||k.empty();i.hide();this.$element.trigger(f,[a.data(),a])}e.find(d).eq(0).removeClass(m).addClass(l)},selectedItems:function(){var a=this.$element.find(".tree-selected"),b=[];c.each(a,function(e,i){b.push(c(i).data())});return b},collapse:function(){var a=this.options.cacheItems;this.$element.find(".icon-folder-open").each(function(){var b=c(this).removeClass("icon-folder-close icon-folder-open").addClass("icon-folder-close").parent().parent().children(".tree-folder-content");
b.hide();a||b.empty()})}};c.fn.xtree=function(a){var b=Array.prototype.slice.call(arguments,1),e,i=this.each(function(){var j=c(this),k=j.data("tree"),d=typeof a==="object"&&a;k||j.data("tree",k=new h(this,d));if(typeof a==="string")e=k[a].apply(k,b)});return e===g?i:e};c.fn.xtree.defaults={isRender:true,multiSelect:false,loadingHTML:"<div>Loading...</div>",cacheItems:true,iconOpen:"xtree-icon fa fa-folder-open icon-folder-open",iconClose:"xtree-icon fa fa-folder icon-folder-close",selectable:true,
iconSelected:"xtree-icon fa fa-check icon-ok",iconUnSelected:"xtree-icon fa fa-times icon-remove"};c.fn.xtree.Constructor=h;c.fn.xtree.noConflict=function(){c.fn.xtree=n;return this}})(window.jQuery);
(function(c,g){c.DataSourceTree=g()})(this,function(){var c=function(g){this._data=g.data;this._delay=g.delay};c.prototype.data=function(g,n){var h=null;if(!("name"in g)&&!("type"in g)){h=this._data;n({data:h})}else{if("type"in g&&g.type=="folder")h="additionalParameters"in g&&"children"in g.additionalParameters?g.additionalParameters.children:{};h!=null&&setTimeout(function(){n({data:h})},parseInt(Math.random()*500)+200)}};return c});